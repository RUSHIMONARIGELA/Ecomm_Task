<div class="container mt-4">
  <!-- Header with Filter/Sort Options -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-primary fw-bold mb-0">Explore Our Products</h2>
    <div class="d-flex gap-2">
      <button class="btn btn-sm btn-outline-secondary d-flex align-items-center">
        <i class="bi bi-funnel me-1"></i> Filter
      </button>
      <button class="btn btn-sm btn-outline-secondary d-flex align-items-center">
        <i class="bi bi-sort-alpha-down me-1"></i> Sort
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading amazing products...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="bi bi-exclamation-triangle-fill me-2"></i>
    {{ error }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" (click)="error = null"></button>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && !error && products.length === 0" class="text-center py-5">
    <i class="bi bi-box-seam fs-1 text-muted mb-3"></i>
    <h4 class="text-muted mb-2">No products found!</h4>
    <p class="text-muted mb-4">
      It looks like there are no products available at the moment.
      <br>
      <a routerLink="/" class="text-primary text-decoration-none">Go back to home</a>
    </p>
  </div>

  <!-- Products Grid -->
  <div *ngIf="!loading && !error && products.length > 0" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
    <div class="col" *ngFor="let product of products">
      <div class="card h-100 border-0 shadow-sm rounded-4 overflow-hidden transition-hover">
        <!-- Product Image -->
        <div class="position-relative">
          <img
            [src]="product.images[0] || 'https://placehold.co/400x300/e0e0e0/555555?text=No+Image'"
            class="card-img-top bg-light"
            alt="{{ product.name }}"
            style="height: 220px; object-fit: cover;"
          >
          <span
            *ngIf="product.stockQuantity === 0"
            class="position-absolute top-0 start-0 m-2 badge bg-danger rounded-pill"
          >
            Sold Out
          </span>
        </div>

        <!-- Product Body -->
        <div class="card-body d-flex flex-column p-3">
          <h6 class="card-title text-truncate fw-semibold mb-1">{{ product.name }}</h6>
          <small class="text-muted mb-2">{{ product.categoryName }}</small>
          <p class="card-text text-muted small flex-grow-1 mb-3">
            {{ product.description | slice:0:80 }}...
          </p>

          <!-- Price and Stock -->
          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="fs-5 fw-bold text-success">â‚¹{{ product.price | number:'1.2-2' }}</span>
            <span
              [ngClass]="{
                'text-success': product.stockQuantity > 10,
                'text-warning': product.stockQuantity <= 10 && product.stockQuantity > 0,
                'text-danger': product.stockQuantity === 0
              }"
              class="small fw-semibold"
            >
              {{ product.stockQuantity > 0 ? product.stockQuantity + ' in stock' : 'Out of stock' }}
            </span>
          </div>

          <!-- Action Button -->
          <div class="d-grid">
            <button
              class="btn btn-sm btn-outline-primary"
              [routerLink]="['/login']"
              [queryParams]="{ redirectTo: '/product/' + product.id }"
            >
              <i class="bi bi-cart-plus me-1"></i>
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
